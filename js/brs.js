"use strict";!function(a){var e={attribute:{name:0,nativeName:1},rtl:{ar:1,dv:1,fa:1,ha:1,he:1,ks:1,ku:1,ps:1,ur:1,yi:1},lang:{aa:["Afar","Afar"],ab:["Abkhazian","Аҧсуа"],af:["Afrikaans","Afrikaans"],ak:["Akan","Akana"],am:["Amharic","አማርኛ"],an:["Aragonese","Aragonés"],ar:["Arabic","العربية"],as:["Assamese","অসমীয়া"],av:["Avar","Авар"],ay:["Aymara","Aymar"],az:["Azerbaijani","Azərbaycanca / آذربايجان"],ba:["Bashkir","Башҡорт"],be:["Belarusian","Беларуская"],bg:["Bulgarian","Български"],bh:["Bihari","भोजपुरी"],bi:["Bislama","Bislama"],bm:["Bambara","Bamanankan"],bn:["Bengali","বাংলা"],bo:["Tibetan","བོད་ཡིག / Bod skad"],br:["Breton","Brezhoneg"],bs:["Bosnian","Bosanski"],ca:["Catalan","Català"],ce:["Chechen","Нохчийн"],ch:["Chamorro","Chamoru"],co:["Corsican","Corsu"],cr:["Cree","Nehiyaw"],cs:["Czech","Česky"],cu:["Old Church Slavonic / Old Bulgarian","словѣньскъ / slověnĭskŭ"],cv:["Chuvash","Чăваш"],cy:["Welsh","Cymraeg"],da:["Danish","Dansk"],de:["German","Deutsch"],dv:["Divehi","ދިވެހިބަސް"],dz:["Dzongkha","ཇོང་ཁ"],ee:["Ewe","Ɛʋɛ"],el:["Greek","Ελληνικά"],en:["English","English"],eo:["Esperanto","Esperanto"],es:["Spanish","Español"],et:["Estonian","Eesti"],eu:["Basque","Euskara"],fa:["Persian","فارسی"],ff:["Peul","Fulfulde"],fi:["Finnish","Suomi"],fj:["Fijian","Na Vosa Vakaviti"],fo:["Faroese","Føroyskt"],fr:["French","Français"],fy:["West Frisian","Frysk"],ga:["Irish","Gaeilge"],gd:["Scottish Gaelic","Gàidhlig"],gl:["Galician","Galego"],gn:["Guarani","Avañe'ẽ"],gu:["Gujarati","ગુજરાતી"],gv:["Manx","Gaelg"],ha:["Hausa","هَوُسَ"],he:["Hebrew","עברית"],hi:["Hindi","हिन्दी"],ho:["Hiri Motu","Hiri Motu"],hr:["Croatian","Hrvatski"],ht:["Haitian","Krèyol ayisyen"],hu:["Hungarian","Magyar"],hy:["Armenian","Հայերեն"],hz:["Herero","Otsiherero"],ia:["Interlingua","Interlingua"],id:["Indonesian","Bahasa Indonesia"],ie:["Interlingue","Interlingue"],ig:["Igbo","Igbo"],ii:["Sichuan Yi","ꆇꉙ / 四川彝语"],ik:["Inupiak","Iñupiak"],io:["Ido","Ido"],is:["Icelandic","Íslenska"],it:["Italian","Italiano"],iu:["Inuktitut","ᐃᓄᒃᑎᑐᑦ"],ja:["Japanese","日本語"],jv:["Javanese","Basa Jawa"],ka:["Georgian","ქართული"],kg:["Kongo","KiKongo"],ki:["Kikuyu","Gĩkũyũ"],kj:["Kuanyama","Kuanyama"],kk:["Kazakh","Қазақша"],kl:["Greenlandic","Kalaallisut"],km:["Cambodian","ភាសាខ្មែរ"],kn:["Kannada","ಕನ್ನಡ"],ko:["Korean","한국어"],kr:["Kanuri","Kanuri"],ks:["Kashmiri","कश्मीरी / كشميري"],ku:["Kurdish","Kurdî / كوردی"],kv:["Komi","Коми"],kw:["Cornish","Kernewek"],ky:["Kirghiz","Kırgızca / Кыргызча"],la:["Latin","Latina"],lb:["Luxembourgish","Lëtzebuergesch"],lg:["Ganda","Luganda"],li:["Limburgian","Limburgs"],ln:["Lingala","Lingála"],lo:["Laotian","ລາວ / Pha xa lao"],lt:["Lithuanian","Lietuvių"],lv:["Latvian","Latviešu"],mg:["Malagasy","Malagasy"],mh:["Marshallese","Kajin Majel / Ebon"],mi:["Maori","Māori"],mk:["Macedonian","Македонски"],ml:["Malayalam","മലയാളം"],mn:["Mongolian","Монгол"],mo:["Moldovan","Moldovenească"],mr:["Marathi","मराठी"],ms:["Malay","Bahasa Melayu"],mt:["Maltese","bil-Malti"],my:["Burmese","Myanmasa"],na:["Nauruan","Dorerin Naoero"],nd:["North Ndebele","Sindebele"],ne:["Nepali","नेपाली"],ng:["Ndonga","Oshiwambo"],nl:["Dutch","Nederlands"],nn:["Norwegian Nynorsk","Norsk (nynorsk)"],no:["Norwegian","Norsk (bokmål / riksmål)"],nr:["South Ndebele","isiNdebele"],nv:["Navajo","Diné bizaad"],ny:["Chichewa","Chi-Chewa"],oc:["Occitan","Occitan"],oj:["Ojibwa","ᐊᓂᔑᓈᐯᒧᐎᓐ / Anishinaabemowin"],om:["Oromo","Oromoo"],or:["Oriya","ଓଡ଼ିଆ"],os:["Ossetian / Ossetic","Иронау"],pa:["Panjabi / Punjabi","ਪੰਜਾਬੀ / पंजाबी / پنجابي"],pi:["Pali","Pāli / पाऴि"],pl:["Polish","Polski"],ps:["Pashto","پښتو"],pt:["Portuguese","Português"],qu:["Quechua","Runa Simi"],rm:["Raeto Romance","Rumantsch"],rn:["Kirundi","Kirundi"],ro:["Romanian","Română"],ru:["Russian","Русский"],rw:["Rwandi","Kinyarwandi"],sa:["Sanskrit","संस्कृतम्"],sc:["Sardinian","Sardu"],sd:["Sindhi","सिनधि"],se:["Northern Sami","Sámegiella"],sg:["Sango","Sängö"],sh:["Serbo-Croatian","Srpskohrvatski / Српскохрватски"],si:["Sinhalese","සිංහල"],sk:["Slovak","Slovenčina"],sl:["Slovenian","Slovenščina"],sm:["Samoan","Gagana Samoa"],sn:["Shona","chiShona"],so:["Somalia","Soomaaliga"],sq:["Albanian","Shqip"],sr:["Serbian","Српски"],ss:["Swati","SiSwati"],st:["Southern Sotho","Sesotho"],su:["Sundanese","Basa Sunda"],sv:["Swedish","Svenska"],sw:["Swahili","Kiswahili"],ta:["Tamil","தமிழ்"],te:["Telugu","తెలుగు"],tg:["Tajik","Тоҷикӣ"],th:["Thai","ไทย / Phasa Thai"],ti:["Tigrinya","ትግርኛ"],tk:["Turkmen","Туркмен / تركمن"],tl:["Tagalog / Filipino","Tagalog"],tn:["Tswana","Setswana"],to:["Tonga","Lea Faka-Tonga"],tr:["Turkish","Türkçe"],ts:["Tsonga","Xitsonga"],tt:["Tatar","Tatarça"],tw:["Twi","Twi"],ty:["Tahitian","Reo Mā`ohi"],ug:["Uyghur","Uyƣurqə / ئۇيغۇرچە"],uk:["Ukrainian","Українська"],ur:["Urdu","اردو"],uz:["Uzbek","Ўзбек"],ve:["Venda","Tshivenḓa"],vi:["Vietnamese","Tiếng Việt"],vo:["Volapük","Volapük"],wa:["Walloon","Walon"],wo:["Wolof","Wollof"],xh:["Xhosa","isiXhosa"],yi:["Yiddish","ייִדיש"],yo:["Yoruba","Yorùbá"],za:["Zhuang","Cuengh / Tôô / 壮语"],zh:["Chinese","中文"],zu:["Zulu","isiZulu"]}},n=function a(n){return e.rtl[n]?"rtl":"ltr"};a.isValid=function(a){return e.lang.hasOwnProperty(a)},a.getAllLanguageCode=function(){var a=[];for(var n in e.lang)a.push(n);return a},a.getLanguageInfo=function(t){var i={};if(a.isValid(t)){var r=e.lang[t];i.name=r[0],i.nativeName=r[1],i.direction=n(t)}return i}}("undefined"==typeof exports?window.languages={}:exports);var BrsOData=function a(e,n,t,i){this.url=e,this.urlProfiles=n,this.fail=i||function(){},this.done=t||function(){}};BrsOData.CONVENTIONS=[{name:"basel"},{name:"rotterdam"},{name:"stockholm"}],BrsOData.LANGUAGES=window.languages.getAllLanguageCode().map(function(a){var e=window.languages.getLanguageInfo(a);return{id:a,name:e.name,value:e.nativeName}}),BrsOData.LISTTYPETOFIELD={term:"Terms",programme:"Programs",tag:"Tags",meetingtype:"MeetingsTypes",chemical:"Chemicals",meeting:"Meetings",type:"Types"},BrsOData.prototype.ODATA3SCHEMA={data:function a(e){return e.value},total:function a(e){return e["odata.count"]}},BrsOData.prototype.getDataSource=function(a){return new kendo.data.DataSource({type:"odata",transport:{read:{url:a.baseUrl+"/"+a.entryUrl+"/",dataType:"jsonp",data:$.extend({$inlinecount:"allpages"},a.data)}},sort:a.sort,serverPaging:!0,serverSorting:!0,page:a.page,pageSize:a.pageSize,schema:{data:function a(e){return e.value?e.value:e.d.results},total:function a(e){return e["odata.count"]?e["odata.count"]:e.d.__count},serverPaging:!0,model:{fields:a.fields}}})},BrsOData.prototype.listTypesDataSource=function(){return this.getDataSource({baseUrl:this.url,entryUrl:"ValueTypes",fields:{id:"ListPropertyTypeId",value:"Name"}})},BrsOData.prototype.countriesDataSource=function(){return this.getDataSource({baseUrl:this.urlProfiles,entryUrl:"countryNames",fields:{id:"IsoCode2d",value:"NameEn"},sort:{field:"NameEn"}})},BrsOData.prototype.conventionsDataSource=function(){return new kendo.data.DataSource({type:"json",data:BrsOData.CONVENTIONS.slice(),sort:{field:"value",dir:"asc"},schema:{model:{fields:{value:"name"}}}})},BrsOData.prototype.languagesDataSource=function(){return new kendo.data.DataSource({type:"json",data:$.merge([],BrsOData.LANGUAGES)})},BrsOData.prototype.yearsDataSource=function(a){var e=(new Date).getFullYear();if(a>e)throw"start year '"+a+"' should be less then current year '"+e+"'";for(var n=[],t=e;t>=a;--t)n.push({value:t});return new kendo.data.DataSource({type:"json",data:n})},BrsOData.prototype.listTypeToField=function(a){return BrsOData.LISTTYPETOFIELD[a]},BrsOData.prototype.listsDataSources=function(){var a=this.listTypesDataSource(),e=this;return a.read().then(function(){var n=[];return _.each(a.view(),function(a){var t=e.getDataSource({baseUrl:e.url,entryUrl:"Values",data:{$filter:"Types/any(x: x/ListPropertyTypeId eq guid'"+a.id+"')"},fields:{id:"ListPropertyId",value:"Value"},sort:{field:"value",dir:"asc"}});n.push({type:a.value,data:t})}),n})},BrsOData.prototype._odataOr=function(a,e,n){var t=[],i="'";n=n||"eq";for(var r in e)"null"!==e[r]&&"number"!=typeof e[r]||(i=""),t.push(a+" "+n+" "+i+e[r]+i);return t.join(" or ")},BrsOData.prototype._odataExpandOr=function(a,e,n){var t=[];for(var i in n){var r="'"+n[i]+"'";this.isGUID(n[i])&&(r="guid"+r),t.push(a+"/any(x: x/"+e+" eq "+r+")")}return t.join(" or ")},BrsOData.prototype.isGUID=function(a){return/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(a)},BrsOData.prototype.documentsDataSource=function(a){var e=[],n="",t=a.filters;if(t)for(var i in t){var r=t[i];if("boolean"==typeof r||r.length>0)switch(i){case"convention":e.push("("+this._odataOr("Convention",r)+")");break;case"language":e.push("("+this._odataExpandOr("Titles","Language",r)+")");break;case"year":e.push("("+this._odataOr("year(PublicationDate)",r)+")");break;case"country":e.push("("+this._odataOr("Country",r)+")");break;case"showEmptyCountry":r&&e.push("("+this._odataOr("Country",["null"],"ne")+")");break;default:var s=this.listTypeToField(i);e.push("("+this._odataExpandOr(s,"ListPropertyId",r)+")")}}return n=e.join(" and "),this.getDataSource({baseUrl:this.url,entryUrl:"Documents",data:{$expand:"Titles,Descriptions,Files",$filter:n},page:a.page,pageSize:a.pageSize,sort:a.sort})},$.fn.brsODataUI=function(a){function e(a){g[$(a.sender.element).data("brs-filter")]=this.value(),o(u.documentsDataSource(h))}function n(a){$("select[data-brs-list]",l.parentEl).each(function(n,t){var i=$(t).data("brs-filter"),r=_.find(a,function(a){return a.type==i}).data;$(t).kendoMultiSelect({dataSource:r,dataTextField:"value",dataValueField:"id",change:e}).data("kendoMultiSelect").value(g[i])})}function t(a){$("select[data-brs-filter='convention']",l.parentEl).each(function(n,t){$(t).kendoMultiSelect({dataSource:a,dataTextField:"value",dataValueField:"value",change:e}).data("kendoMultiSelect").value(g.convention)})}function i(a){$("select[data-brs-filter='language']",l.parentEl).each(function(n,t){$(t).kendoMultiSelect({dataSource:a,dataTextField:"name",dataValueField:"id",change:e})})}function r(a){$("select[data-brs-filter='year']",l.parentEl).each(function(n,t){$(t).kendoMultiSelect({dataSource:a,dataTextField:"value",dataValueField:"value",change:e})})}function s(a){$("select[data-brs-filter='country']",l.parentEl).each(function(n,t){$(t).kendoMultiSelect({dataSource:a,dataTextField:"value",dataValueField:"id",change:e})})}function o(a){$("tbody[data-brs-documents]",l.parentEl).each(function(e,n){var t=c||kendo.template($("#brs-template").html()),i=$(".brs-documents-pager");$(n).kendoListView({dataSource:a,template:t,autoBind:!0,dataBound:function a(){$(".brs-tabstrip",l).each(function(){var a;if(0==g.language.length)a=$("li:first-child");else for(var e=g.language.length-1;e>=0&&(a=$(".brs-tab-"+g.language[e],this),!(a.size()>0));e--);$(this).kendoTabStrip().data("kendoTabStrip").activateTab(a)})}}),i.kendoPager({dataSource:a})})}var l=this,u=a.service,d=a.predefined||{},c=a.template,g={convention:[],language:[],year:[],term:[],programme:[],tag:[],meetingtype:[],chemical:[],meeting:[],type:[],country:[],showEmptyCountry:!0};g=jQuery.extend(g,d);var h={filters:g,page:1,pageSize:a.pageSize||10,sort:{field:"PublicationDate",dir:"desc"}};u.listsDataSources().then(n),t(u.conventionsDataSource()),i(u.languagesDataSource()),r(u.yearsDataSource(2005)),s(u.countriesDataSource()),o(u.documentsDataSource(h))},$.fn.brsODataUIBuilder=function(a){var e='<div id="brs-filters">',n=new BrsOData("http://informea.pops.int/BrsDocuments/MFiles.svc/","http://informea.pops.int/CountryProfiles/bcTreatyProfile.svc"),t=kendo.template('<div class="brs-filter brs-terms-container">   #= title#   <select data-brs-filter="#= type#" #= list?"data-brs-list":""#></select></div>'),i={};for(var r in a){var s=a[r];(void 0===s.show||1==s.show)&&(e+=t($.extend({list:!1},s))),i[s.type]=s.selected||[]}e+="</div>",e+='<div>\n                <div class="brs-documents">\n                    <table>\n                        <thead>\n                            <tr>\n                                <!--<th>UNnumber</th>-->\n                                <th>Treaty</th>\n                                <th>Country</th>\n                                <th>Publication Date</th>\n                                <th>&nbsp;</th>\n                            </tr>\n                        </thead>\n                        <tbody data-brs-documents>\n                        </tbody>\n                    </table>\n                </div>\n                <div class="brs-documents-pager"></div>\n        </div>';var o='<tr>\n            <td>#= Convention#</td>\n            <td>#= CountryFull != null? CountryFull: "" #</td>\n            <td>#= PublicationDate != null? kendo.toString(kendo.parseDate(PublicationDate), "y"): "" #</td>\n            <td>\n                    <div class="brs-tabstrip">\n                    <ul>\n                            #  var found;# \n                            #  for (var j = 0; j < Titles.length; j++) { #\n                            #      found = false; # \n                            #      for (var i = 0; i < BrsOData.LANGUAGES.length; i++) { #\n                            #        if (BrsOData.LANGUAGES[i].id == Titles[j].Language) { #\n                                        <li class="brs-tab brs-tab-#: BrsOData.LANGUAGES[i].id#">  #= BrsOData.LANGUAGES[i].value #</li>\n                            #          found=true; break; # \n                            #        } #   \n                            #      } #\n                            #      if (!found){#\n                                        <li class="brs-tab brs-tab-#: Titles[j].Language#">  #= Titles[j].LanguageFull #</li>\n                            #      } #\n                            #  } #\n                    </ul>\n                    # for (var j = 0; j < Titles.length; j++) { #\n                            # for (var i = 0; i < BrsOData.LANGUAGES.length; i++) { #\n                                # found = false; #\n                                # if (BrsOData.LANGUAGES[i].id == Titles[j].Language) {#\n                                    <div>\n                                        <div class="brs-tab-content brs-tab-title">#= Titles[j].Value #</div>\n                                        <!--<div class="brs-tab-content brs-tab-unnumber">#: UnNumber #</div>-->\n                                        <div class="brs-tab-content brs-tab-description">#= Descriptions[j].Value #</div>\n                                        <div class="brs-tab-content brs-tab-files">\n                                            # for (var l = 0; l < Files.length; l++) { # \n                                                    #   if (Files[l].Size == 0 ) {#\n                                                        #      if (Files[l].Extension == \'txt\') {#\n                                                            <div class="brs-tab-content brs-tab-notyet">Not yet implemented</div>\n                                                        #      }#\n                                                    #   } else {#    \n                                                        #   if (Files[l].Language == Titles[j].Language) {#\n                                                        <span class="brs-tab-files-link">\n                                                            <a href="#:Files[l].Url#">#:Files[l].Extension#</a>\n                                                        </span>\n                                                    #}}#\n                                            \n                                            # } #\n                                        </div>\n                                    </div>\n                                    # found = true; break; #\n                                # } #   \n                            # } #\n                    # } #\n                </div>\n            </td>\n        </tr>';$(this).html(e),$(this).brsODataUI({service:n,predefined:i,template:'<tr>\n            <td>#= Convention#</td>\n            <td>#= CountryFull != null? CountryFull: "" #</td>\n            <td>#= PublicationDate != null? kendo.toString(kendo.parseDate(PublicationDate), "y"): "" #</td>\n            <td>\n                    <div class="brs-tabstrip">\n                    <ul>\n                            #  var found;# \n                            #  for (var j = 0; j < Titles.length; j++) { #\n                            #      found = false; # \n                            #      for (var i = 0; i < BrsOData.LANGUAGES.length; i++) { #\n                            #        if (BrsOData.LANGUAGES[i].id == Titles[j].Language) { #\n                                        <li class="brs-tab brs-tab-#: BrsOData.LANGUAGES[i].id#">  #= BrsOData.LANGUAGES[i].value #</li>\n                            #          found=true; break; # \n                            #        } #   \n                            #      } #\n                            #      if (!found){#\n                                        <li class="brs-tab brs-tab-#: Titles[j].Language#">  #= Titles[j].LanguageFull #</li>\n                            #      } #\n                            #  } #\n                    </ul>\n                    # for (var j = 0; j < Titles.length; j++) { #\n                            # for (var i = 0; i < BrsOData.LANGUAGES.length; i++) { #\n                                # found = false; #\n                                # if (BrsOData.LANGUAGES[i].id == Titles[j].Language) {#\n                                    <div>\n                                        <div class="brs-tab-content brs-tab-title">#= Titles[j].Value #</div>\n                                        <!--<div class="brs-tab-content brs-tab-unnumber">#: UnNumber #</div>-->\n                                        <div class="brs-tab-content brs-tab-description">#= Descriptions[j].Value #</div>\n                                        <div class="brs-tab-content brs-tab-files">\n                                            # for (var l = 0; l < Files.length; l++) { # \n                                                    #   if (Files[l].Size == 0 ) {#\n                                                        #      if (Files[l].Extension == \'txt\') {#\n                                                            <div class="brs-tab-content brs-tab-notyet">Not yet implemented</div>\n                                                        #      }#\n                                                    #   } else {#    \n                                                        #   if (Files[l].Language == Titles[j].Language) {#\n                                                        <span class="brs-tab-files-link">\n                                                            <a href="#:Files[l].Url#">#:Files[l].Extension#</a>\n                                                        </span>\n                                                    #}}#\n                                            \n                                            # } #\n                                        </div>\n                                    </div>\n                                    # found = true; break; #\n                                # } #   \n                            # } #\n                    # } #\n                </div>\n            </td>\n        </tr>'})};